#!/bin/sh

set -eu
if set -o | grep -q pipefail; then set -o pipefail; fi
set -x

D=$(dirname $0)

for cfg_cmd in \
    'backuprc;source' \
    'bashrc;source' \
    'gdbinit;source' \
    'screenrc;source' \
    'tmux.conf;source-file' \
    'vimrc;source'; do
  cfg=$D/${cfg_cmd%;*}
  cmd=${cfg_cmd#*;}
  echo "$cmd $cfg" >> $HOME/.$f
done

cat >> $HOME/$f <<EOF
[include]
    path = $D/gitconfig
EOF

for f in $(cd $D && find .vim -type f); do
  mkdir -p $HOME/$(dirname $f)
  ln -s $D/$f $HOME/$f
done

echo "PATH=$D/bin:$PATH" >> $HOME/.bashrc
